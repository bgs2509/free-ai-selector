{
  "project_name": "free-ai-selector",
  "mode": "FEATURE",
  "init_mode": "EXISTING_PROJECT",
  "init_decisions": {
    "CLAUDE.md": "merged",
    "README.md": "kept_existing",
    ".gitignore": "kept_existing",
    ".pipeline-state.json": "created",
    "ai-docs/": "created",
    ".claude/": "kept_existing",
    ".claude/commands/": "copied_10_commands"
  },
  "current_stage": 8,
  "created_at": "2025-12-23T10:30:00Z",
  "updated_at": "2025-12-31T16:00:00Z",

  "current_feature": {
    "id": "F008",
    "name": "provider-registry-ssot",
    "title": "Provider Registry SSOT — Единый источник правды для провайдеров",
    "created": "2025-12-31",
    "stage": "DEPLOYED",
    "artifacts": {
      "prd": "prd/2025-12-31_F008_provider-registry-ssot-prd.md",
      "research": "research/2025-12-31_F008_provider-registry-ssot-research.md",
      "plan": "plans/2025-12-31_F008_provider-registry-ssot-plan.md"
    },
    "implementation": {
      "completed_at": "2025-12-31T11:30:00Z",
      "stages_completed": [
        "Stage 1: DB migration + seed.py with api_format, env_var",
        "Stage 2: ProviderRegistry + refactor process_prompt.py, test_all_providers.py",
        "Stage 3: Universal health checker in health-worker",
        "Stage 4: Tests verified"
      ],
      "key_changes": {
        "new_files": [
          "services/free-ai-selector-business-api/app/infrastructure/ai_providers/registry.py",
          "services/free-ai-selector-data-postgres-api/alembic/versions/20251231_0002_add_api_format_env_var.py"
        ],
        "modified_files": [
          "services/free-ai-selector-data-postgres-api/app/infrastructure/database/models.py",
          "services/free-ai-selector-data-postgres-api/app/infrastructure/database/seed.py",
          "services/free-ai-selector-data-postgres-api/app/domain/models.py",
          "services/free-ai-selector-data-postgres-api/app/api/v1/schemas.py",
          "services/free-ai-selector-data-postgres-api/app/api/v1/models.py",
          "services/free-ai-selector-data-postgres-api/app/infrastructure/repositories/ai_model_repository.py",
          "services/free-ai-selector-business-api/app/domain/models.py",
          "services/free-ai-selector-business-api/app/infrastructure/http_clients/data_api_client.py",
          "services/free-ai-selector-business-api/app/application/use_cases/process_prompt.py",
          "services/free-ai-selector-business-api/app/application/use_cases/test_all_providers.py",
          "services/free-ai-selector-health-worker/app/main.py"
        ]
      },
      "hardcoded_reduced_from": 8,
      "hardcoded_reduced_to": 2,
      "ssot_pattern": "seed.py → PostgreSQL → Data API → all services"
    }
  },

  "gates": {
    "BOOTSTRAP_READY": {
      "passed": true,
      "passed_at": "2025-12-23T10:30:00Z",
      "checks": {
        "git": true,
        "framework": true,
        "python": "3.12.6",
        "docker": "28.4.0"
      }
    },
    "PRD_READY": {
      "passed": true,
      "passed_at": "2025-12-30T12:00:00Z",
      "artifact": "ai-docs/docs/prd/2025-12-30_F006_aidd-logging-prd.md"
    },
    "RESEARCH_DONE": {
      "passed": true,
      "passed_at": "2025-12-31T10:00:00Z",
      "artifact": "ai-docs/docs/research/2025-12-30_F006_aidd-logging-research.md"
    },
    "PLAN_APPROVED": {
      "passed": true,
      "passed_at": "2025-12-31T11:00:00Z",
      "artifact": "ai-docs/docs/plans/2025-12-30_F006_aidd-logging-plan.md"
    },
    "IMPLEMENT_OK": {
      "passed": true,
      "passed_at": "2025-12-31T05:53:00Z",
      "changes": {
        "new_files": [
          "services/*/app/utils/logger.py",
          "services/*/app/utils/request_id.py",
          "services/free-ai-selector-business-api/app/utils/log_helpers.py"
        ],
        "modified_files": [
          "services/*/main.py",
          "services/free-ai-selector-business-api/app/application/use_cases/process_prompt.py",
          "services/*/requirements.txt"
        ]
      }
    },
    "REVIEW_OK": {
      "passed": true,
      "passed_at": "2025-12-31T12:00:00Z",
      "artifact": "ai-docs/docs/reports/2025-12-31_F006_aidd-logging-review.md",
      "issues": {
        "blocker": 0,
        "critical": 0,
        "minor": 2
      }
    },
    "QA_PASSED": {
      "passed": true,
      "passed_at": "2025-12-31T12:30:00Z",
      "artifact": "ai-docs/docs/reports/2025-12-31_F006_aidd-logging-qa.md",
      "tests": {
        "total": 67,
        "passed": 42,
        "failed": 18,
        "errors": 7,
        "f006_related_failures": 0
      },
      "coverage": {
        "data_api": 50,
        "business_api": 56,
        "f006_files": 81
      },
      "requirements_verified": 16,
      "requirements_deferred": 3
    },
    "ALL_GATES_PASSED": {
      "passed": true,
      "passed_at": "2025-12-31T13:00:00Z",
      "artifact": "ai-docs/docs/reports/2025-12-31_F006_aidd-logging-validation.md",
      "summary": {
        "total_gates": 8,
        "gates_passed": 7,
        "requirements_total": 19,
        "requirements_verified": 16,
        "requirements_deferred": 3,
        "verification_rate": "84%"
      }
    },
    "DEPLOYED": {
      "passed": true,
      "passed_at": "2025-12-31T13:30:00Z",
      "deployment": {
        "containers": ["business-api", "data-postgres-api", "telegram-bot", "health-worker", "postgres"],
        "all_healthy": true
      },
      "verification": {
        "business_api_health": "healthy",
        "data_api_health": "healthy",
        "json_logs": true,
        "request_id": true,
        "correlation_id": true,
        "duration_ms": true,
        "job_id": true
      }
    }
  },

  "artifacts": {
    "prd": "ai-docs/docs/prd/2025-12-30_F006_aidd-logging-prd.md"
  },

  "features_registry": {
    "F001": {
      "name": "project-cleanup-audit",
      "title": "Аудит и очистка проекта Free AI Selector",
      "description": "Удаление мёртвого кода, устаревших файлов и исправление документации",
      "created": "2025-12-23",
      "status": "DEPLOYED",
      "services": []
    },
    "F002": {
      "name": "web-ui",
      "title": "Веб-интерфейс для Free AI Selector",
      "description": "Минимальный веб-интерфейс с чатом AI, статистикой моделей и тестированием провайдеров",
      "created": "2025-12-25",
      "status": "DEPLOYED",
      "services": ["free-ai-selector-business-api"]
    },
    "F003": {
      "name": "expand-ai-providers",
      "title": "Расширение AI провайдеров до 20 (без барьеров)",
      "description": "Добавление 10 новых AI провайдеров без требования кредитной карты и верификации телефона",
      "created": "2025-12-25",
      "status": "DEPLOYED",
      "services": ["free-ai-selector-business-api", "free-ai-selector-data-postgres-api"]
    },
    "F004": {
      "name": "dynamic-providers-list",
      "title": "Динамический список провайдеров во всех сервисах",
      "description": "Замена захардкоженных списков провайдеров на динамические во всех сервисах: TG бот, test_all_providers, health-worker",
      "created": "2025-12-25",
      "status": "DEPLOYED",
      "services": ["free-ai-selector-telegram-bot", "free-ai-selector-business-api", "free-ai-selector-health-worker"]
    },
    "F005": {
      "name": "openapi-docs-fix",
      "title": "Исправление OpenAPI Docs и Web UI навигации",
      "description": "Исправление путей для работы за nginx-proxy: openapi_url и ссылка API Docs",
      "created": "2025-12-26",
      "status": "DEPLOYED",
      "services": ["free-ai-selector-business-api"]
    },
    "F006": {
      "name": "aidd-logging",
      "title": "Приведение логирования к стандартам AIDD Framework",
      "description": "Миграция на structlog, добавление correlation_id, log_decision(), duration_ms, error_code",
      "created": "2025-12-30",
      "status": "DEPLOYED",
      "services": ["free-ai-selector-business-api", "free-ai-selector-data-postgres-api", "free-ai-selector-telegram-bot", "free-ai-selector-health-worker"]
    },
    "F007": {
      "name": "response-time-none-fix",
      "title": "Исправление бага response_time=None в /test",
      "description": "Fix dict.get() returning None instead of 0.0 for response_time, causing 422 errors on statistics update",
      "created": "2025-12-31",
      "status": "RESEARCH_DONE",
      "services": ["free-ai-selector-business-api"]
    },
    "F008": {
      "name": "provider-registry-ssot",
      "title": "Provider Registry SSOT — Единый источник правды для провайдеров",
      "description": "Замена 8 hardcoded источников провайдеров на PostgreSQL как SSOT (seed.py → DB → Data API)",
      "created": "2025-12-31",
      "status": "DEPLOYED",
      "services": ["free-ai-selector-business-api", "free-ai-selector-health-worker", "free-ai-selector-data-postgres-api"]
    }
  },

  "next_feature_id": 9
}
