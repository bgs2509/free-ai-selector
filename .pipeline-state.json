{
  "$schema": "pipeline-state-schema",
  "version": "2.0",
  "naming_version": "v3",
  "project_name": "free-ai-selector",
  "mode": "FEATURE",
  "init_mode": "EXISTING_PROJECT",
  "init_decisions": {
    "CLAUDE.md": "merged",
    "README.md": "kept_existing",
    ".gitignore": "kept_existing",
    ".pipeline-state.json": "created",
    "ai-docs/": "created",
    ".claude/": "kept_existing",
    ".claude/commands/": "copied_10_commands"
  },
  "parallel_mode": false,
  "created_at": "2025-12-23T10:30:00Z",
  "updated_at": "2026-02-26T10:40:00.000000",
  "global_gates": {
    "BOOTSTRAP_READY": {
      "passed": true,
      "passed_at": "2025-12-23T10:30:00Z",
      "checks": {
        "git": true,
        "framework": true,
        "python": "3.12.6",
        "docker": "28.4.0"
      }
    }
  },
  "active_pipelines": {
    "F011-A": {
      "branch": "feature/F011-A-remove-non-openai-providers",
      "name": "remove-non-openai-providers",
      "title": "Удаление нестандартных AI провайдеров (GoogleGemini и Cohere)",
      "stage": "DEPLOYED",
      "created": "2026-01-15",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-01-03T10:00:00Z",
          "artifact": "_analysis/2026-01-15_F011-A_remove-non-openai-providers.md",
          "version": 2,
          "notes": "Updated with Section 4 (Pipelines) per AIDD framework v2"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-01-03T11:00:00Z",
          "artifact": null,
          "findings": {
            "extension_points_data_api": 4,
            "extension_points_business_api": 4,
            "migration_required": false,
            "index_exists": "ix_prompt_history_created_at"
          }
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-01-03T12:00:00Z",
          "artifact": null,
          "approved_by": "user",
          "summary": {
            "data_api_changes": 4,
            "business_api_changes": 4,
            "new_lines": 200,
            "modified_lines": 75,
            "migration_required": false
          }
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-01-03T18:00:00Z",
          "files_changed": [
            "services/free-ai-selector-data-postgres-api/app/infrastructure/repositories/prompt_history_repository.py",
            "services/free-ai-selector-data-postgres-api/app/api/v1/schemas.py",
            "services/free-ai-selector-data-postgres-api/app/api/v1/models.py",
            "services/free-ai-selector-business-api/app/domain/models.py",
            "services/free-ai-selector-business-api/app/infrastructure/http_clients/data_api_client.py",
            "services/free-ai-selector-business-api/app/application/use_cases/process_prompt.py",
            "services/free-ai-selector-business-api/tests/conftest.py",
            "services/free-ai-selector-business-api/tests/unit/test_process_prompt_use_case.py"
          ],
          "tests": {
            "f010_specific": "8/8 passed",
            "business_api_total": "63/75 passed (pre-existing failures)"
          }
        },
        "REVIEW_OK": {
          "passed": true,
          "passed_at": "2026-01-15T16:30:00Z",
          "artifact": "_validation/2026-01-15_F011-A_remove-non-openai-providers-review.md",
          "decision": "APPROVED_WITH_COMMENTS",
          "blocker_issues": 0,
          "critical_issues": 0,
          "minor_issues": 3,
          "notes": "Clean implementation. F008 SSOT maintained. 3 minor cosmetic issues (non-blocking). Safe to merge."
        },
        "QA_PASSED": {
          "passed": true,
          "passed_at": "2026-01-15T17:00:00Z",
          "artifact": "_validation/2026-01-15_F011-A_remove-non-openai-providers-qa.md",
          "tests_executed": 95,
          "tests_passed": 70,
          "tests_failed": 18,
          "f011a_specific_failures": 0,
          "coverage_data_api": "55.26%",
          "coverage_business_api": "56.74%",
          "pre_existing_issues": 18,
          "notes": "QA PASSED with conditions: All F011-A requirements verified. 0 F011-A failures. 18 pre-existing test failures tracked separately as technical debt. Coverage below 75% is pre-existing issue."
        },
        "ALL_GATES_PASSED": {
          "passed": true,
          "passed_at": "2026-01-15T17:30:00Z",
          "artifacts": {
            "rtm": "_validation/2026-01-15_F011-A_remove-non-openai-providers-rtm.md",
            "validation": "_validation/2026-01-15_F011-A_remove-non-openai-providers-validation.md"
          },
          "requirements_coverage": "100%",
          "gates_passed": 8,
          "notes": "All requirements traced and verified. 100% implementation, testing, and verification coverage. Ready for deployment."
        },
        "DEPLOYED": {
          "passed": true,
          "passed_at": "2026-01-15T18:00:00Z",
          "deployment_method": "make build && make up",
          "health_checks": "OK",
          "providers_active": 14,
          "notes": "F011-A deployed successfully. 14 OpenAI-compatible providers active. GoogleGemini and Cohere removed. Completion Report created."
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-01-15_F011-A_remove-non-openai-providers.md",
        "review": "_validation/2026-01-15_F011-A_remove-non-openai-providers-review.md",
        "qa": "_validation/2026-01-15_F011-A_remove-non-openai-providers-qa.md",
        "validation": "_validation/2026-01-15_F011-A_remove-non-openai-providers-validation.md",
        "completion": "_validation/2026-01-15_F011-A_remove-non-openai-providers.md"
      }
    },
    "F011-B": {
      "branch": "feature/F011-B-system-prompts-json-response",
      "name": "system-prompts-json-response",
      "title": "System Prompts & JSON Response Support",
      "stage": "REVIEW",
      "created": "2026-01-15",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-01-15T14:00:00Z",
          "artifact": "_analysis/2026-01-15_F011-B_system-prompts-json-response.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-01-15T14:55:00Z",
          "artifact": "_research/2026-01-15_F011-B_system-prompts-json-response.md"
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-01-15T15:30:00Z",
          "artifact": "_plans/features/2026-01-15_F011-B_system-prompts-json-response.md",
          "approved_by": "user",
          "summary": {
            "files_to_modify": 18,
            "files_to_create": 2,
            "providers_affected": 14,
            "breaking_changes": false,
            "db_migrations_required": false,
            "estimated_hours": "4-5"
          }
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-01-15T19:00:00Z",
          "files_changed": [
            "services/free-ai-selector-business-api/app/api/v1/schemas.py",
            "services/free-ai-selector-business-api/app/domain/models.py",
            "services/free-ai-selector-business-api/app/application/use_cases/process_prompt.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/base.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/groq.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/cerebras.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/sambanova.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/huggingface.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/cloudflare.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/deepseek.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/openrouter.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/github_models.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/fireworks.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/hyperbolic.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/novita.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/scaleway.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/kluster.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/nebius.py",
            "services/free-ai-selector-business-api/tests/unit/test_process_prompt_use_case.py",
            "services/free-ai-selector-business-api/tests/unit/test_f011b_schemas.py"
          ],
          "tests": {
            "f011b_specific": "11 tests created (5 use_case + 6 schemas)",
            "implementation_status": "Complete: API layer, Domain layer, Application layer, Infrastructure layer (14 providers), Tests",
            "type_hints_coverage": "100%",
            "backward_compatible": true
          }
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-01-15_F011-B_system-prompts-json-response.md",
        "research": "_research/2026-01-15_F011-B_system-prompts-json-response.md",
        "plan": "_plans/features/2026-01-15_F011-B_system-prompts-json-response.md"
      }
    },
    "F012": {
      "branch": "feature/F012-rate-limit-handling",
      "name": "rate-limit-handling",
      "title": "Rate Limit Handling для AI Провайдеров",
      "stage": "IMPLEMENT",
      "created": "2026-01-29",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-01-29T12:54:27.276320",
          "artifact": "_analysis/2026-01-29_F012_rate-limit-handling.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-01-29T17:02:59.279516",
          "artifact": "_research/2026-01-29_F012_rate-limit-handling.md"
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-01-29T21:00:00Z",
          "artifact": "_plans/features/2026-01-29_F012_rate-limit-handling.md",
          "approved_by": "user",
          "quality_cascade": "16/16",
          "summary": {
            "services_affected": 3,
            "files_to_create": 3,
            "files_to_modify": 10,
            "db_migration_required": true,
            "breaking_changes": false,
            "estimated_loc": 840
          }
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-01-29T23:30:00Z",
          "files_changed": [
            "services/free-ai-selector-data-postgres-api/app/infrastructure/database/models.py",
            "services/free-ai-selector-data-postgres-api/app/domain/models.py",
            "services/free-ai-selector-data-postgres-api/app/api/v1/schemas.py",
            "services/free-ai-selector-data-postgres-api/app/infrastructure/repositories/ai_model_repository.py",
            "services/free-ai-selector-data-postgres-api/app/api/v1/models.py",
            "services/free-ai-selector-data-postgres-api/alembic/versions/004_add_available_at.py",
            "services/free-ai-selector-data-postgres-api/tests/unit/test_ai_model_repository.py",
            "services/free-ai-selector-business-api/app/domain/exceptions.py",
            "services/free-ai-selector-business-api/app/application/services/error_classifier.py",
            "services/free-ai-selector-business-api/app/application/services/retry_service.py",
            "services/free-ai-selector-business-api/app/domain/models.py",
            "services/free-ai-selector-business-api/app/infrastructure/http_clients/data_api_client.py",
            "services/free-ai-selector-business-api/app/application/use_cases/process_prompt.py",
            "services/free-ai-selector-business-api/tests/unit/test_error_classifier.py",
            "services/free-ai-selector-business-api/tests/unit/test_retry_service.py",
            "services/free-ai-selector-business-api/tests/unit/test_f012_rate_limit_handling.py",
            "services/free-ai-selector-business-api/tests/conftest.py",
            "services/free-ai-selector-business-api/tests/unit/test_process_prompt_use_case.py",
            "services/free-ai-selector-health-worker/app/main.py",
            "docker-compose.yml"
          ],
          "tests": {
            "f012_specific": "34 tests created",
            "test_files": [
              "test_error_classifier.py (12 tests)",
              "test_retry_service.py (11 tests)",
              "test_f012_rate_limit_handling.py (6 tests)",
              "test_ai_model_repository.py (5 F012 tests)"
            ],
            "type_hints_coverage": "100%",
            "backward_compatible": true
          }
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        },
        "DOCUMENTED": {
          "passed": true,
          "passed_at": "2026-01-30T10:15:00Z",
          "mode": "quick",
          "artifact": "_validation/2026-01-30_F012_rate-limit-handling.md"
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-01-29_F012_rate-limit-handling.md",
        "research": "_research/2026-01-29_F012_rate-limit-handling.md",
        "plan": "_plans/features/2026-01-29_F012_rate-limit-handling.md",
        "completion": "_validation/2026-01-30_F012_rate-limit-handling.md"
      }
    },
    "F013": {
      "branch": "master",
      "name": "ai-providers-consolidation",
      "title": "AI Providers Consolidation: OpenAICompatibleProvider",
      "stage": "VALIDATED",
      "created": "2026-01-30",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-01-30T12:00:00Z",
          "artifact": "_analysis/2026-01-30_F013_ai-providers-consolidation.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-01-30T14:30:00Z",
          "artifact": "_research/2026-01-30_F013_ai-providers-consolidation.md",
          "findings": {
            "providers_analyzed": 14,
            "openai_compatible": 12,
            "excluded": [
              "cloudflare"
            ],
            "hook_methods_needed": [
              "_build_url",
              "_build_headers",
              "_is_health_check_success"
            ],
            "expected_reduction": "~80%",
            "lines_before": 1820,
            "lines_after": 350
          }
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-01-30T15:00:00Z",
          "artifact": "_plans/features/2026-01-30_F013_ai-providers-consolidation.md",
          "approved_by": "user",
          "summary": {
            "files_to_modify": 13,
            "base_class_lines": 120,
            "providers_to_convert": 12,
            "cloudflare_excluded": true,
            "breaking_changes": false,
            "db_migration_required": false
          }
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-01-30T17:00:00Z",
          "files_changed": [
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/base.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/groq.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/cerebras.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/sambanova.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/huggingface.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/deepseek.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/openrouter.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/github_models.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/fireworks.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/hyperbolic.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/novita.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/scaleway.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/kluster.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/nebius.py",
            "services/free-ai-selector-business-api/tests/unit/test_new_providers.py"
          ],
          "tests": {
            "f013_specific": "31 provider tests passed",
            "total_passed": "122 passed",
            "total_failed": "4 (pre-existing static file tests)",
            "implementation_status": "Complete: OpenAICompatibleProvider base class, 12 providers converted",
            "lines_reduced": "~1100 lines (from 1820 to ~300)",
            "type_hints_coverage": "100%",
            "backward_compatible": true
          }
        },
        "REVIEW_OK": {
          "passed": true,
          "passed_at": "2026-01-30T18:00:00Z",
          "artifact": "_validation/2026-01-30_F013_ai-providers-consolidation.md",
          "decision": "APPROVED",
          "blocker_issues": 0,
          "critical_issues": 0,
          "minor_issues": 2,
          "notes": "Clean refactoring. DRY achieved. E501 lint issues fixed."
        },
        "QA_PASSED": {
          "passed": true,
          "passed_at": "2026-01-30T18:00:00Z",
          "artifact": "_validation/2026-01-30_F013_ai-providers-consolidation.md",
          "tests_executed": 31,
          "tests_passed": 31,
          "tests_failed": 0,
          "f013_specific_failures": 0,
          "notes": "All 31 provider tests passed. 122 total tests passed (4 pre-existing failures unrelated to F013)."
        },
        "ALL_GATES_PASSED": {
          "passed": true,
          "passed_at": "2026-01-30T18:00:00Z",
          "artifact": "_validation/2026-01-30_F013_ai-providers-consolidation.md",
          "requirements_coverage": "100%",
          "gates_passed": 7,
          "notes": "All requirements traced and verified. Ready for deployment."
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-01-30_F013_ai-providers-consolidation.md",
        "research": "_research/2026-01-30_F013_ai-providers-consolidation.md",
        "plan": "_plans/features/2026-01-30_F013_ai-providers-consolidation.md",
        "completion": "_validation/2026-01-30_F013_ai-providers-consolidation.md"
      }
    },
    "F014": {
      "branch": "master",
      "name": "process-prompt-simplification",
      "title": "ProcessPromptUseCase: Error Handling Consolidation",
      "stage": "IMPLEMENT",
      "created": "2026-01-30",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-01-30T12:00:00Z",
          "artifact": "_analysis/2026-01-30_F014_process-prompt-simplification.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-01-30T19:30:00Z",
          "artifact": "_research/2026-01-30_F014_process-prompt-simplification.md",
          "findings": {
            "error_handling_lines": 125,
            "duplication_lines": 64,
            "except_blocks": 5,
            "cyclomatic_complexity_before": "17-20",
            "cyclomatic_complexity_after": "12-15",
            "quality_cascade": "7/7"
          }
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-01-30T20:00:00Z",
          "artifact": "_plans/features/2026-01-30_F014_process-prompt-simplification.md",
          "approved_by": "user",
          "summary": {
            "new_methods": 2,
            "except_blocks_before": 5,
            "except_blocks_after": 3,
            "lines_removed": 75,
            "lines_added": 55,
            "net_change": -20,
            "breaking_changes": false
          }
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-01-30T21:00:00Z",
          "files_changed": [
            "services/free-ai-selector-business-api/app/application/use_cases/process_prompt.py",
            "services/free-ai-selector-business-api/tests/unit/test_process_prompt_use_case.py"
          ],
          "tests": {
            "regression_tests": "11/11 passed",
            "f012_tests": "8/8 passed",
            "f014_new_tests": "6/6 passed",
            "total_tests": "17/17 passed",
            "new_methods": [
              "_handle_rate_limit()",
              "_handle_transient_error()"
            ],
            "except_blocks_reduced": "5 → 3",
            "lines_reduced": "~75",
            "type_hints_coverage": "100%",
            "backward_compatible": true
          }
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        },
        "DOCUMENTED": {
          "passed": true,
          "passed_at": "2026-01-30T21:30:00Z",
          "mode": "quick",
          "artifact": "_validation/2026-01-30_F014_process-prompt-simplification.md"
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-01-30_F014_process-prompt-simplification.md",
        "research": "_research/2026-01-30_F014_process-prompt-simplification.md",
        "plan": "_plans/features/2026-01-30_F014_process-prompt-simplification.md",
        "completion": "_validation/2026-01-30_F014_process-prompt-simplification.md"
      }
    },
    "F015": {
      "branch": "master",
      "name": "data-api-endpoints-dry",
      "title": "Data API Endpoints: DRY Refactoring",
      "stage": "IMPLEMENT",
      "created": "2026-01-30",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-01-30T12:00:00Z",
          "artifact": "_analysis/2026-01-30_F015_data-api-endpoints-dry.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-01-30T22:00:00Z",
          "artifact": "_research/2026-01-30_F015_data-api-endpoints-dry.md",
          "findings": {
            "target_file": "app/api/v1/models.py",
            "total_lines": 463,
            "converter_duplication": 37,
            "get404_duplication": 56,
            "total_duplication": 93,
            "endpoints_affected": 7,
            "quality_cascade": "7/7"
          }
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-01-30T22:30:00Z",
          "artifact": "_plans/features/2026-01-30_F015_data-api-endpoints-dry.md",
          "approved_by": "user",
          "summary": {
            "files_to_modify": 2,
            "new_components": 1,
            "loc_change": -44,
            "endpoints_affected": 6,
            "breaking_changes": false,
            "db_migration_required": false
          }
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-01-30T23:00:00Z",
          "files_changed": [
            "services/free-ai-selector-data-postgres-api/app/api/deps.py",
            "services/free-ai-selector-data-postgres-api/app/api/v1/models.py",
            "services/free-ai-selector-data-postgres-api/tests/unit/test_f015_dry_refactoring.py"
          ],
          "tests": {
            "f015_specific": "8/8 passed",
            "test_files": [
              "test_f015_dry_refactoring.py (8 tests)"
            ],
            "implementation_status": "Complete: unified _model_to_response(), get_model_or_404 dependency, get_model_by_id migrated",
            "notes": "Only get_model_by_id migrated to dependency; other 5 endpoints use repository methods returning None, using dependency would cause double DB queries",
            "type_hints_coverage": "100%",
            "backward_compatible": true
          }
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        },
        "DOCUMENTED": {
          "passed": true,
          "passed_at": "2026-01-30T23:30:00Z",
          "mode": "quick",
          "artifact": "_validation/2026-01-30_F015_data-api-endpoints-dry.md"
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-01-30_F015_data-api-endpoints-dry.md",
        "research": "_research/2026-01-30_F015_data-api-endpoints-dry.md",
        "plan": "_plans/features/2026-01-30_F015_data-api-endpoints-dry.md",
        "completion": "_validation/2026-01-30_F015_data-api-endpoints-dry.md"
      }
    },
    "F016": {
      "branch": "master",
      "name": "reliability-score-ssot",
      "title": "Reliability Score: Single Source of Truth",
      "stage": "IMPLEMENT",
      "created": "2026-01-30",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-01-30T12:00:00Z",
          "artifact": "_analysis/2026-01-30_F016_reliability-score-ssot.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-01-30T23:45:00Z",
          "artifact": "_research/2026-01-30_F016_reliability-score-ssot.md"
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-01-31T00:00:00Z",
          "artifact": "_plans/features/2026-01-30_F016_reliability-score-ssot.md",
          "approved_by": "user"
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-01-30T17:26:43+00:00",
          "files_changed": [
            "services/free-ai-selector-data-postgres-api/app/domain/services/__init__.py",
            "services/free-ai-selector-data-postgres-api/app/domain/services/reliability_service.py",
            "services/free-ai-selector-data-postgres-api/app/domain/models.py",
            "services/free-ai-selector-data-postgres-api/app/api/v1/models.py",
            "services/free-ai-selector-data-postgres-api/tests/unit/test_reliability_service.py"
          ],
          "tests": {
            "f016_specific": "6/6 passed (new ReliabilityService tests)",
            "regression_domain": "9/9 passed",
            "regression_f015": "8/8 passed",
            "total_unit_tests": "23/23 passed",
            "implementation_status": "Complete: ReliabilityService created, domain/models.py migrated, api/v1/models.py migrated",
            "duplication_eliminated": "2 locations (domain/models.py, api/v1/models.py)",
            "ssot_established": "ReliabilityService.calculate()",
            "type_hints_coverage": "100%",
            "backward_compatible": true
          }
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        },
        "DOCUMENTED": {
          "passed": true,
          "passed_at": "2026-01-30T23:59:00Z",
          "mode": "quick",
          "artifact": "_validation/2026-01-30_F016_reliability-score-ssot.md"
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-01-30_F016_reliability-score-ssot.md",
        "research": "_research/2026-01-30_F016_reliability-score-ssot.md",
        "plan": "_plans/features/2026-01-30_F016_reliability-score-ssot.md",
        "completion": "_validation/2026-01-30_F016_reliability-score-ssot.md"
      }
    },
    "F017": {
      "branch": "master",
      "name": "repositories-sql-optimization",
      "title": "Data API Repositories: SQL Aggregation Optimization",
      "stage": "IMPLEMENT",
      "created": "2026-01-30",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-01-30T12:00:00Z",
          "artifact": "_analysis/2026-01-30_F017_repositories-sql-optimization.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-01-31T00:00:00Z",
          "artifact": "_research/2026-01-30_F017_repositories-sql-optimization.md",
          "findings": {
            "target_method": "get_statistics_for_period",
            "current_approach": "Python aggregation (loads all records)",
            "optimized_approach": "SQL aggregation (func.count, func.sum)",
            "reference_implementation": "get_recent_stats_for_all_models (lines 155-202)",
            "index_exists": "ix_prompt_history_created_at",
            "performance_gain": "50-100x for large datasets",
            "memory_optimization": "O(n) → O(1)",
            "breaking_changes": false
          }
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-01-31T00:15:00Z",
          "artifact": "_plans/features/2026-01-30_F017_repositories-sql-optimization.md",
          "approved_by": "user",
          "summary": {
            "files_to_modify": 1,
            "target_method": "get_statistics_for_period",
            "optimization": "Python aggregation → SQL aggregation",
            "lines_to_change": 40,
            "tests_to_create": 6,
            "breaking_changes": false,
            "estimated_hours": "2.5"
          }
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-01-31T01:00:00Z",
          "summary": {
            "optimized_method": "get_statistics_for_period",
            "approach": "Replaced Python aggregation with SQL aggregation (func.count, func.sum)",
            "files_modified": [
              "services/free-ai-selector-data-postgres-api/app/infrastructure/repositories/prompt_history_repository.py"
            ],
            "tests_created": "tests/unit/test_prompt_history_repository.py (6 test cases)",
            "tests_status": "All 6 tests PASSED",
            "dependencies_added": [
              "aiosqlite==0.20.0"
            ],
            "breaking_changes": false,
            "backward_compatible": true
          }
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        },
        "DOCUMENTED": {
          "passed": true,
          "passed_at": "2026-01-31T01:30:00Z",
          "mode": "quick",
          "artifact": "_validation/2026-01-31_F017_repositories-sql-optimization.md"
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-01-30_F017_repositories-sql-optimization.md",
        "research": "_research/2026-01-30_F017_repositories-sql-optimization.md",
        "plan": "_plans/features/2026-01-30_F017_repositories-sql-optimization.md",
        "completion": "_validation/2026-01-31_F017_repositories-sql-optimization.md"
      }
    },
    "F018": {
      "branch": "master",
      "name": "remove-env-var-from-db",
      "title": "Удаление env_var из БД, SSOT через ProviderRegistry",
      "stage": "IMPLEMENT",
      "created": "2026-02-11",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-02-11T12:00:00Z",
          "artifact": "_analysis/2026-02-11_F018_remove-env-var-from-db.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-02-11T12:30:00Z",
          "artifact": "_research/2026-02-11_F018_remove-env-var-from-db.md",
          "findings": {
            "total_files_affected": 16,
            "providers_with_api_key_env": 13,
            "cloudflare_missing_api_key_env": true,
            "cloudflare_env_var_bug": "seed.py says CLOUDFLARE_API_KEY, actual is CLOUDFLARE_API_TOKEN",
            "telegram_bot_affected": false,
            "env_var_occurrences": 61,
            "alembic_head": "0003_add_available_at",
            "new_migration": "0004_drop_env_var",
            "breaking_changes_external": false
          }
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-02-11T13:00:00Z",
          "artifact": "_plans/features/2026-02-11_F018_remove-env-var-from-db.md",
          "approved_by": "user",
          "summary": {
            "steps": 9,
            "files_to_modify": 12,
            "files_to_create": 1,
            "db_migration_required": true,
            "breaking_changes": false
          }
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-02-11T15:00:00Z",
          "files_changed": [
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/cloudflare.py",
            "services/free-ai-selector-business-api/app/infrastructure/ai_providers/registry.py",
            "services/free-ai-selector-business-api/app/application/use_cases/process_prompt.py",
            "services/free-ai-selector-business-api/app/domain/models.py",
            "services/free-ai-selector-business-api/app/infrastructure/http_clients/data_api_client.py",
            "services/free-ai-selector-business-api/tests/conftest.py",
            "services/free-ai-selector-business-api/tests/unit/test_process_prompt_use_case.py",
            "services/free-ai-selector-business-api/tests/unit/test_f012_rate_limit_handling.py",
            "services/free-ai-selector-data-postgres-api/app/infrastructure/database/models.py",
            "services/free-ai-selector-data-postgres-api/app/domain/models.py",
            "services/free-ai-selector-data-postgres-api/app/api/v1/schemas.py",
            "services/free-ai-selector-data-postgres-api/app/api/v1/models.py",
            "services/free-ai-selector-data-postgres-api/app/infrastructure/repositories/ai_model_repository.py",
            "services/free-ai-selector-data-postgres-api/app/infrastructure/database/seed.py",
            "services/free-ai-selector-data-postgres-api/alembic/versions/20260211_0004_drop_env_var.py",
            "services/free-ai-selector-data-postgres-api/tests/unit/test_f015_dry_refactoring.py",
            "services/free-ai-selector-health-worker/app/main.py"
          ],
          "tests": {
            "implementation_status": "Complete: env_var removed from all 3 services, Alembic migration created, seed upsert+cleanup, ProviderRegistry SSOT",
            "changes_summary": {
              "data_api": "Removed env_var from ORM, domain, schema, repository, API response; seed.py upsert+cleanup",
              "business_api": "ProviderRegistry.get_api_key_env() SSOT; Cloudflare API_KEY_ENV added; process_prompt uses registry",
              "health_worker": "PROVIDER_ENV_VARS dict for env var lookup by provider name",
              "migration": "0004_drop_env_var (DROP COLUMN ai_models.env_var)",
              "tests": "All test fixtures updated, ProviderRegistry mocked in unit tests"
            },
            "type_hints_coverage": "100%",
            "backward_compatible": true
          }
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        },
        "DOCUMENTED": {
          "passed": true,
          "passed_at": "2026-02-11T15:30:00Z",
          "mode": "quick",
          "artifact": "_validation/2026-02-11_F018_remove-env-var-from-db.md"
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-02-11_F018_remove-env-var-from-db.md",
        "research": "_research/2026-02-11_F018_remove-env-var-from-db.md",
        "plan": "_plans/features/2026-02-11_F018_remove-env-var-from-db.md",
        "completion": "_validation/2026-02-11_F018_remove-env-var-from-db.md"
      }
    },
    "F019": {
      "branch": "master",
      "name": "model-id-priority-fallback",
      "title": "Выбор модели по model_id с fallback на авто-выбор",
      "stage": "REVIEW",
      "created": "2026-02-11",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-02-11T17:21:00Z",
          "artifact": "_analysis/2026-02-11_F019_model-id-priority-fallback.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-02-11T17:28:59Z",
          "artifact": "_research/2026-02-11_F019_model-id-priority-fallback.md",
          "findings": {
            "target_service": "free-ai-selector-business-api",
            "required_production_files": 4,
            "required_test_files": 2,
            "new_dependencies_required": false,
            "recommended_selection_strategy": "in-memory-reorder",
            "extra_data_api_calls_required": 0,
            "backward_compatibility": true,
            "quality_cascade": "7/7"
          }
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-02-11T17:33:42Z",
          "artifact": "_plans/features/2026-02-11_F019_model-id-priority-fallback.md",
          "approved_by": "user",
          "summary": {
            "files_to_modify": 4,
            "files_to_test": 2,
            "db_migration_required": false,
            "breaking_changes": false
          }
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-02-11T17:41:14Z",
          "files_changed": [
            "services/free-ai-selector-business-api/app/api/v1/schemas.py",
            "services/free-ai-selector-business-api/app/api/v1/prompts.py",
            "services/free-ai-selector-business-api/app/domain/models.py",
            "services/free-ai-selector-business-api/app/application/use_cases/process_prompt.py",
            "services/free-ai-selector-business-api/tests/unit/test_f011b_schemas.py",
            "services/free-ai-selector-business-api/tests/unit/test_process_prompt_use_case.py"
          ],
          "tests": {
            "attempted": "pytest -s -o addopts='' tests/unit/test_f011b_schemas.py tests/unit/test_process_prompt_use_case.py",
            "status": "not_executed",
            "reason": "Local environment is missing required dependencies (pydantic, structlog) and default pytest addopts requires unavailable pytest-cov plugin",
            "backward_compatible": true
          }
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null,
          "coverage": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        },
        "DOCUMENTED": {
          "passed": true,
          "passed_at": "2026-02-11T17:48:39Z",
          "mode": "quick",
          "artifact": "_validation/2026-02-11_F019_model-id-priority-fallback.md"
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-02-11_F019_model-id-priority-fallback.md",
        "research": "_research/2026-02-11_F019_model-id-priority-fallback.md",
        "plan": "_plans/features/2026-02-11_F019_model-id-priority-fallback.md",
        "completion": "_validation/2026-02-11_F019_model-id-priority-fallback.md"
      }
    },
    "F020": {
      "branch": "master",
      "name": "web-model-selection-stage1",
      "title": "Web UI: выбор конкретной AI модели (Stage 1)",
      "stage": "REVIEW",
      "created": "2026-02-13",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-02-13T08:43:03Z",
          "artifact": "_analysis/2026-02-13_F020_web-model-selection-stage1.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-02-13T08:43:03Z",
          "artifact": "_research/2026-02-13_F020_web-model-selection-stage1.md",
          "findings": {
            "scope": "web-only-stage1",
            "manual_model_min_score": 0.4,
            "auto_switch_on_error": true,
            "telegram_affected": false,
            "settings_affected": false,
            "target_file": "services/free-ai-selector-business-api/app/static/index.html"
          }
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-02-13T09:05:10Z",
          "artifact": "_plans/features/2026-02-13_F020_web-model-selection-stage1.md",
          "approved_by": "user",
          "summary": {
            "scope": "web-only-stage1",
            "files_to_modify": 1,
            "db_migration_required": false,
            "breaking_changes": false,
            "new_dependencies": false
          }
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-02-13T09:05:10Z",
          "files_changed": [
            "services/free-ai-selector-business-api/app/static/index.html"
          ],
          "tests": {
            "status": "not_executed",
            "reason": "Frontend-only change; smoke scenarios prepared in plan, automated UI tests not requested"
          },
          "notes": {
            "manual_model_min_score": 0.4,
            "auto_switch_on_empty_or_error": true,
            "show_score_in_option": true,
            "telegram_unchanged": true
          }
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-02-13_F020_web-model-selection-stage1.md",
        "research": "_research/2026-02-13_F020_web-model-selection-stage1.md",
        "plan": "_plans/features/2026-02-13_F020_web-model-selection-stage1.md"
      }
    },
    "F021": {
      "branch": "master",
      "name": "compose-nginx-local-modes",
      "title": "Два независимых compose-файла: make nginx/make loc с корректным root_path",
      "stage": "REVIEW",
      "created": "2026-02-13",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-02-13T12:52:31Z",
          "artifact": "_analysis/2026-02-13_F021_compose-nginx-local-modes.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-02-13T13:17:39Z",
          "artifact": "_research/2026-02-13_F021_compose-nginx-local-modes.md",
          "findings": {
            "compose_strategy": "independent_files_no_override",
            "target_compose_files": [
              "docker-compose.nginx.yml",
              "docker-compose.loc.yml"
            ],
            "make_mode_commands": [
              "nginx",
              "loc"
            ],
            "business_root_path_dynamic": true,
            "data_openapi_needs_root_path_fix": true,
            "ui_api_base_hardcoded_prefix": true,
            "deploy_script_removed_for_simplification": true
          }
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-02-13T13:46:06Z",
          "artifact": "_plans/features/2026-02-13_F021_compose-nginx-local-modes.md",
          "approved_by": "user",
          "summary": {
            "compose_files": 2,
            "approach": "independent_configs_no_override",
            "must_have_comments": true,
            "deploy_script_removed": true,
            "db_migration_required": false,
            "breaking_changes_api": false
          }
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-02-13T14:41:30Z",
          "files_changed": [
            "docker-compose.nginx.yml",
            "docker-compose.loc.yml",
            "Makefile",
            "services/free-ai-selector-data-postgres-api/app/main.py",
            "services/free-ai-selector-business-api/app/static/index.html",
            "README.md",
            "docs/operations/quick-start.md",
            "docs/operations/deployment.md",
            "docs/operations/development.md",
            "docs/operations/troubleshooting.md"
          ],
          "tests": {
            "compose_validation": "docker compose -f docker-compose.nginx.yml config --services",
            "compose_validation_loc": "docker compose -f docker-compose.loc.yml config --services",
            "json_validation": "python3 -m json.tool .pipeline-state.json",
            "automated_tests": "not_run",
            "reason": "Изменения инфраструктурные и документационные; запуск pytest не запрошен в задаче."
          }
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-02-13_F021_compose-nginx-local-modes.md",
        "research": "_research/2026-02-13_F021_compose-nginx-local-modes.md",
        "plan": "_plans/features/2026-02-13_F021_compose-nginx-local-modes.md"
      }
    },
    "F022": {
      "branch": "feature/F022-error-classifier-fix",
      "name": "error-classifier-fix",
      "title": "Исправление классификации ошибок LLM-провайдеров и защита от больших payload",
      "stage": "IMPLEMENT",
      "created": "2026-02-25",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-02-25T07:51:49.776196",
          "artifact": "_analysis/2026-02-25_F022_error-classifier-fix.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-02-25T07:57:56.113793",
          "findings": {
            "files_to_change": 3,
            "tests_to_add": 2,
            "key_bug": "HTTPStatusError wrapped in ProviderError loses HTTP code",
            "missing_codes": [
              402,
              404
            ],
            "payload_threshold": 6000
          }
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-02-25T08:23:27.430597",
          "artifact": "_plans/features/2026-02-25_F022_error-classifier-fix.md",
          "approved_by": "user"
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-02-25T08:45:00.000000",
          "tests_passed": 36,
          "tests_failed": 0,
          "files_changed": 4
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        },
        "DOCUMENTED": {
          "passed": true,
          "passed_at": "2026-02-25T08:31:00.000000",
          "mode": "quick"
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-02-25_F022_error-classifier-fix.md",
        "research": "_research/2026-02-25_F022_error-classifier-fix.md",
        "plan": "_plans/features/2026-02-25_F022_error-classifier-fix.md",
        "completion": "_validation/2026-02-25_F022_error-classifier-fix.md"
      }
    },
    "F023": {
      "branch": "feature/F023-error-resilience-and-telemetry",
      "name": "error-resilience-and-telemetry",
      "title": "Cooldown для постоянных ошибок, exponential backoff и per-request telemetry",
      "stage": "IMPLEMENT",
      "created": "2026-02-25",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-02-25T09:00:00.000000",
          "artifact": "_analysis/2026-02-25_F023_error-resilience-and-telemetry.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-02-25T07:37:25.518900"
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-02-25T10:00:00.000000",
          "artifact": "_plans/features/2026-02-25_F023_error-resilience-and-telemetry.md",
          "approved_by": "user"
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-02-25T10:30:00.000000"
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        },
        "DOCUMENTED": {
          "passed": true,
          "passed_at": "2026-02-25T11:00:00.000000",
          "mode": "quick"
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-02-25_F023_error-resilience-and-telemetry.md",
        "research": "_research/2026-02-25_F023_error-resilience-and-telemetry.md",
        "plan": "_plans/features/2026-02-25_F023_error-resilience-and-telemetry.md",
        "completion": "_validation/2026-02-25_F023_error-resilience-and-telemetry.md"
      }
    },
    "F024": {
      "branch": "feature/F024-circuit-breaker",
      "name": "circuit-breaker",
      "title": "Circuit Breaker для AI-провайдеров",
      "stage": "REVIEW",
      "created": "2026-02-25",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-02-25T08:01:11.908178",
          "artifact": "_analysis/2026-02-25_F024_circuit-breaker.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-02-25T08:54:58.807243"
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-02-25T09:28:39.644952",
          "artifact": "_plans/features/2026-02-25_F024_circuit-breaker.md",
          "approved_by": "user"
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-02-25T10:15:00.000000"
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null,
          "coverage": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        },
        "DOCUMENTED": {
          "passed": true,
          "passed_at": "2026-02-25T10:36:00.000000",
          "mode": "quick"
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-02-25_F024_circuit-breaker.md",
        "research": "_research/2026-02-25_F024_circuit-breaker.md",
        "plan": "_plans/features/2026-02-25_F024_circuit-breaker.md",
        "completion": "_validation/2026-02-25_F024_circuit-breaker.md"
      }
    },
    "F025": {
      "branch": "feature/F025-adaptive-concurrency",
      "name": "server-backpressure",
      "title": "Серверная защита от перегрузки: HTTP 429/503 + backpressure",
      "stage": "REVIEW",
      "created": "2026-02-25",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-02-25T09:30:00.000000",
          "artifact": "_analysis/2026-02-25_F025_server-backpressure.md",
          "version": 2,
          "notes": "PRD v2: полная переформулировка — серверная защита вместо клиентского AC"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-02-25T09:55:27.305502+00:00",
          "artifact": "_research/2026-02-25_F025_server-backpressure.md"
        },
        "PLAN_APPROVED": {
          "passed": true,
          "passed_at": "2026-02-25T11:15:00.000000",
          "artifact": "_plans/features/2026-02-25_F025_server-backpressure.md",
          "approved_by": "user"
        },
        "IMPLEMENT_OK": {
          "passed": true,
          "passed_at": "2026-02-25T12:00:00.000000"
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null,
          "coverage": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        },
        "DOCUMENTED": {
          "passed": true,
          "passed_at": "2026-02-25T12:30:00.000000",
          "mode": "quick",
          "artifact": "_validation/2026-02-25_F025_server-backpressure.md"
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-02-25_F025_server-backpressure.md",
        "research": "_research/2026-02-25_F025_server-backpressure.md",
        "plan": "_plans/features/2026-02-25_F025_server-backpressure.md",
        "completion": "_validation/2026-02-25_F025_server-backpressure.md"
      },
      "services": ["free-ai-selector-business-api"]
    },
    "F026": {
      "branch": "master",
      "name": "unified-json-logging",
      "title": "Унификация логов в единый JSON-формат",
      "stage": "PLAN",
      "created": "2026-02-26",
      "gates": {
        "PRD_READY": {
          "passed": true,
          "passed_at": "2026-02-26T10:40:00.000000",
          "artifact": "_analysis/2026-02-26_F026_unified-json-logging.md"
        },
        "RESEARCH_DONE": {
          "passed": true,
          "passed_at": "2026-02-26T11:00:00.000000",
          "artifact": "_research/2026-02-26_F026_unified-json-logging.md"
        },
        "PLAN_APPROVED": {
          "passed": false,
          "passed_at": null,
          "artifact": null,
          "approved_by": null
        },
        "IMPLEMENT_OK": {
          "passed": false,
          "passed_at": null
        },
        "REVIEW_OK": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "QA_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null,
          "coverage": null
        },
        "ALL_GATES_PASSED": {
          "passed": false,
          "passed_at": null,
          "artifact": null
        },
        "DEPLOYED": {
          "passed": false,
          "passed_at": null
        }
      },
      "artifacts": {
        "prd": "_analysis/2026-02-26_F026_unified-json-logging.md",
        "research": "_research/2026-02-26_F026_unified-json-logging.md",
        "plan": "_plans/features/2026-02-26_F026_unified-json-logging.md"
      },
      "services": [
        "free-ai-selector-business-api",
        "free-ai-selector-data-postgres-api",
        "free-ai-selector-health-worker",
        "free-ai-selector-telegram-bot"
      ]
    }
  },
  "features_registry": {
    "F001": {
      "name": "project-cleanup-audit",
      "title": "Аудит и очистка проекта Free AI Selector",
      "description": "Удаление мёртвого кода, устаревших файлов и исправление документации",
      "created": "2025-12-23",
      "status": "DEPLOYED",
      "services": []
    },
    "F002": {
      "name": "web-ui",
      "title": "Веб-интерфейс для Free AI Selector",
      "description": "Минимальный веб-интерфейс с чатом AI, статистикой моделей и тестированием провайдеров",
      "created": "2025-12-25",
      "status": "DEPLOYED",
      "services": [
        "free-ai-selector-business-api"
      ]
    },
    "F003": {
      "name": "expand-ai-providers",
      "title": "Расширение AI провайдеров до 20 (без барьеров)",
      "description": "Добавление 10 новых AI провайдеров без требования кредитной карты и верификации телефона",
      "created": "2025-12-25",
      "status": "DEPLOYED",
      "services": [
        "free-ai-selector-business-api",
        "free-ai-selector-data-postgres-api"
      ]
    },
    "F004": {
      "name": "dynamic-providers-list",
      "title": "Динамический список провайдеров во всех сервисах",
      "description": "Замена захардкоженных списков провайдеров на динамические во всех сервисах: TG бот, test_all_providers, health-worker",
      "created": "2025-12-25",
      "status": "DEPLOYED",
      "services": [
        "free-ai-selector-telegram-bot",
        "free-ai-selector-business-api",
        "free-ai-selector-health-worker"
      ]
    },
    "F005": {
      "name": "openapi-docs-fix",
      "title": "Исправление OpenAPI Docs и Web UI навигации",
      "description": "Исправление путей для работы за nginx-proxy: openapi_url и ссылка API Docs",
      "created": "2025-12-26",
      "status": "DEPLOYED",
      "services": [
        "free-ai-selector-business-api"
      ]
    },
    "F006": {
      "name": "aidd-logging",
      "title": "Приведение логирования к стандартам AIDD Framework",
      "description": "Миграция на structlog, добавление correlation_id, log_decision(), duration_ms, error_code",
      "created": "2025-12-30",
      "status": "DEPLOYED",
      "services": [
        "free-ai-selector-business-api",
        "free-ai-selector-data-postgres-api",
        "free-ai-selector-telegram-bot",
        "free-ai-selector-health-worker"
      ]
    },
    "F007": {
      "name": "response-time-none-fix",
      "title": "Исправление бага response_time=None в /test",
      "description": "Fix dict.get() returning None instead of 0.0 for response_time, causing 422 errors on statistics update",
      "created": "2025-12-31",
      "status": "RESEARCH_DONE",
      "services": [
        "free-ai-selector-business-api"
      ]
    },
    "F008": {
      "name": "provider-registry-ssot",
      "title": "Provider Registry SSOT — Единый источник правды для провайдеров",
      "description": "Замена 8 hardcoded источников провайдеров на PostgreSQL как SSOT (seed.py → DB → Data API)",
      "created": "2025-12-31",
      "status": "DEPLOYED",
      "services": [
        "free-ai-selector-business-api",
        "free-ai-selector-health-worker",
        "free-ai-selector-data-postgres-api"
      ]
    },
    "F009": {
      "name": "security-logging-hardening",
      "title": "Security Hardening & Reverse Proxy Alignment",
      "description": "SensitiveDataFilter в structlog для автоматической фильтрации секретов, ROOT_PATH для Data API, удаление hardcoded mount",
      "created": "2026-01-01",
      "status": "DEPLOYED",
      "services": [
        "free-ai-selector-business-api",
        "free-ai-selector-data-postgres-api",
        "free-ai-selector-telegram-bot",
        "free-ai-selector-health-worker"
      ]
    },
    "F010": {
      "name": "rolling-window-reliability",
      "title": "Rolling Window Reliability Score",
      "description": "Расчёт reliability_score на основе данных за последние 7 дней из prompt_history для актуального выбора AI модели",
      "created": "2026-01-02",
      "status": "DEPLOYED",
      "services": [
        "free-ai-selector-data-postgres-api",
        "free-ai-selector-business-api"
      ]
    },
    "F011-A": {
      "name": "remove-non-openai-providers",
      "title": "Удаление нестандартных AI провайдеров (GoogleGemini и Cohere)",
      "description": "Удаление GoogleGemini и Cohere провайдеров для упрощения кодовой базы перед добавлением system prompts и response_format",
      "created": "2026-01-15",
      "status": "DEPLOYED",
      "deployed": "2026-01-15",
      "services": [
        "free-ai-selector-business-api",
        "free-ai-selector-data-postgres-api"
      ],
      "blocks": [
        "F011-B"
      ],
      "artifacts": {
        "prd": "_analysis/2026-01-15_F011-A_remove-non-openai-providers.md",
        "review": "_validation/2026-01-15_F011-A_remove-non-openai-providers-review.md",
        "qa": "_validation/2026-01-15_F011-A_remove-non-openai-providers-qa.md",
        "validation": "_validation/2026-01-15_F011-A_remove-non-openai-providers-validation.md",
        "completion": "_validation/2026-01-15_F011-A_remove-non-openai-providers.md"
      }
    },
    "F011-B": {
      "name": "system-prompts-json-response",
      "title": "System Prompts & JSON Response Support",
      "description": "Поддержка system prompts и response_format параметров для 14 OpenAI-compatible провайдеров",
      "created": "2026-01-15",
      "status": "IMPLEMENT_OK",
      "services": [
        "free-ai-selector-business-api"
      ],
      "blocked_by": [
        "F011-A"
      ],
      "artifacts": {
        "prd": "_analysis/2026-01-15_F011-B_system-prompts-json-response.md",
        "research": "_research/2026-01-15_F011-B_system-prompts-json-response.md",
        "plan": "_plans/features/2026-01-15_F011-B_system-prompts-json-response.md"
      }
    },
    "F011-C": {
      "name": "web-ui-advanced-params",
      "title": "Веб-интерфейс: добавление system_prompt и response_format",
      "description": "Добавление поддержки system_prompt и response_format в веб-интерфейс (index.html)",
      "created": "2026-01-15",
      "status": "IMPLEMENT_OK",
      "services": [
        "free-ai-selector-business-api"
      ],
      "blocked_by": [
        "F011-B"
      ],
      "artifacts": {
        "prd": "_analysis/2026-01-15_F011-C_web-ui-advanced-params.md",
        "research": "_research/2026-01-15_F011-C_web-ui-advanced-params.md",
        "plan": "_plans/features/2026-01-15_F011-C_web-ui-advanced-params.md",
        "completion": "_validation/2026-01-15_F011-C_web-ui-advanced-params.md"
      },
      "implementation": {
        "passed_at": "2026-01-15T21:30:00Z",
        "files_modified": 1,
        "lines_added": 66,
        "lines_modified": 20,
        "implementation_steps": [
          "Added CSS classes for format selector (5 classes)",
          "Added HTML textarea for system_prompt with maxlength=5000",
          "Added HTML radio buttons for response_format (Text/JSON)",
          "Modified sendPrompt() to include system_prompt and response_format in payload",
          "Added client-side validation (5000 characters limit)"
        ],
        "files_changed": [
          "services/free-ai-selector-business-api/app/static/index.html"
        ]
      }
    },
    "F012": {
      "name": "rate-limit-handling",
      "title": "Rate Limit Handling для AI Провайдеров",
      "description": "Error classification, fixed retry (10×10s), availability cooldown via available_at, full fallback loop, graceful degradation для обработки HTTP 429",
      "created": "2026-01-29",
      "status": "DOCUMENTED",
      "services": [
        "free-ai-selector-business-api",
        "free-ai-selector-data-postgres-api",
        "free-ai-selector-health-worker"
      ],
      "artifacts": {
        "prd": "_analysis/2026-01-29_F012_rate-limit-handling.md",
        "research": "_research/2026-01-29_F012_rate-limit-handling.md",
        "plan": "_plans/features/2026-01-29_F012_rate-limit-handling.md",
        "completion": "_validation/2026-01-30_F012_rate-limit-handling.md"
      }
    },
    "F013": {
      "name": "ai-providers-consolidation",
      "title": "AI Providers Consolidation: OpenAICompatibleProvider",
      "description": "Рефакторинг: создание OpenAICompatibleProvider базового класса, консолидация 12 OpenAI-compatible провайдеров из ~140 строк каждый в ~27 строк конфигурации. Устранение ~1100 строк дублирования (QC-1/DRY)",
      "created": "2026-01-30",
      "status": "ALL_GATES_PASSED",
      "services": [
        "free-ai-selector-business-api"
      ],
      "artifacts": {
        "prd": "_analysis/2026-01-30_F013_ai-providers-consolidation.md",
        "research": "_research/2026-01-30_F013_ai-providers-consolidation.md",
        "plan": "_plans/features/2026-01-30_F013_ai-providers-consolidation.md",
        "completion": "_validation/2026-01-30_F013_ai-providers-consolidation.md"
      }
    },
    "F014": {
      "name": "process-prompt-simplification",
      "title": "ProcessPromptUseCase: Error Handling Consolidation",
      "description": "Рефакторинг: консолидация 5 except блоков в 2 приватных метода (_handle_rate_limit, _handle_transient_error). Снижение цикломатической сложности с ~25 до ~15 (QC-2/KISS, QC-4/SRP)",
      "created": "2026-01-30",
      "status": "DOCUMENTED",
      "services": [
        "free-ai-selector-business-api"
      ],
      "artifacts": {
        "prd": "_analysis/2026-01-30_F014_process-prompt-simplification.md",
        "research": "_research/2026-01-30_F014_process-prompt-simplification.md",
        "plan": "_plans/features/2026-01-30_F014_process-prompt-simplification.md"
      }
    },
    "F015": {
      "name": "data-api-endpoints-dry",
      "title": "Data API Endpoints: DRY Refactoring",
      "description": "Рефакторинг: объединение _model_to_response() функций, создание get_model_or_404 dependency. Устранение 7 мест дублирования (QC-1/DRY)",
      "created": "2026-01-30",
      "status": "DOCUMENTED",
      "services": [
        "free-ai-selector-data-postgres-api"
      ],
      "artifacts": {
        "prd": "_analysis/2026-01-30_F015_data-api-endpoints-dry.md",
        "research": "_research/2026-01-30_F015_data-api-endpoints-dry.md",
        "plan": "_plans/features/2026-01-30_F015_data-api-endpoints-dry.md",
        "completion": "_validation/2026-01-30_F015_data-api-endpoints-dry.md"
      }
    },
    "F016": {
      "name": "reliability-score-ssot",
      "title": "Reliability Score: Single Source of Truth",
      "description": "Рефакторинг: вынесение расчёта reliability_score в ReliabilityService domain service. Устранение дублирования в 2 местах (QC-10/SSoT)",
      "created": "2026-01-30",
      "status": "DOCUMENTED",
      "services": [
        "free-ai-selector-data-postgres-api"
      ],
      "artifacts": {
        "prd": "_analysis/2026-01-30_F016_reliability-score-ssot.md",
        "research": "_research/2026-01-30_F016_reliability-score-ssot.md",
        "plan": "_plans/features/2026-01-30_F016_reliability-score-ssot.md",
        "completion": "_validation/2026-01-30_F016_reliability-score-ssot.md"
      }
    },
    "F017": {
      "name": "repositories-sql-optimization",
      "title": "Data API Repositories: SQL Aggregation Optimization",
      "description": "Рефакторинг: замена Python loops на SQL aggregation (func.count, func.avg) в get_statistics_for_period(). Оптимизация памяти O(n) → O(1) (QC-2/KISS, Performance)",
      "created": "2026-01-30",
      "status": "DOCUMENTED",
      "services": [
        "free-ai-selector-data-postgres-api"
      ],
      "artifacts": {
        "prd": "_analysis/2026-01-30_F017_repositories-sql-optimization.md",
        "research": "_research/2026-01-30_F017_repositories-sql-optimization.md",
        "plan": "_plans/features/2026-01-30_F017_repositories-sql-optimization.md",
        "completion": "_validation/2026-01-31_F017_repositories-sql-optimization.md"
      }
    },
    "F018": {
      "name": "remove-env-var-from-db",
      "title": "Удаление env_var из БД, SSOT через ProviderRegistry",
      "description": "Удаление колонки env_var из БД, ProviderRegistry как SSOT для API key env var names. Исправление production бага (500 на VPS), устранение SSOT violation, исправление Cloudflare env var mismatch",
      "created": "2026-02-11",
      "status": "DOCUMENTED",
      "services": [
        "free-ai-selector-data-postgres-api",
        "free-ai-selector-business-api",
        "free-ai-selector-health-worker"
      ],
      "artifacts": {
        "prd": "_analysis/2026-02-11_F018_remove-env-var-from-db.md",
        "research": "_research/2026-02-11_F018_remove-env-var-from-db.md",
        "plan": "_plans/features/2026-02-11_F018_remove-env-var-from-db.md",
        "completion": "_validation/2026-02-11_F018_remove-env-var-from-db.md"
      }
    },
    "F019": {
      "name": "model-id-priority-fallback",
      "title": "Выбор модели по model_id с fallback на авто-выбор",
      "description": "Опциональный model_id в /prompts/process: приоритетный вызов запрошенной модели и fallback на стандартный reliability-based выбор при недоступности или ошибке.",
      "created": "2026-02-11",
      "status": "DOCUMENTED",
      "services": [
        "free-ai-selector-business-api"
      ],
      "artifacts": {
        "prd": "_analysis/2026-02-11_F019_model-id-priority-fallback.md",
        "research": "_research/2026-02-11_F019_model-id-priority-fallback.md",
        "plan": "_plans/features/2026-02-11_F019_model-id-priority-fallback.md",
        "completion": "_validation/2026-02-11_F019_model-id-priority-fallback.md"
      }
    },
    "F020": {
      "name": "web-model-selection-stage1",
      "title": "Web UI: выбор конкретной AI модели (Stage 1)",
      "description": "Web-only Stage 1: режим Авто/Конкретная, фильтр моделей по reliability_score > 0.4, показ score в списке и автопереключение в Авто при ошибке/пустом списке.",
      "created": "2026-02-13",
      "status": "IMPLEMENT_OK",
      "services": [
        "free-ai-selector-business-api"
      ],
      "artifacts": {
        "prd": "_analysis/2026-02-13_F020_web-model-selection-stage1.md",
        "research": "_research/2026-02-13_F020_web-model-selection-stage1.md",
        "plan": "_plans/features/2026-02-13_F020_web-model-selection-stage1.md"
      }
    },
    "F021": {
      "name": "compose-nginx-local-modes",
      "title": "Два независимых compose-файла: make nginx/make loc с корректным root_path",
      "description": "Переименование текущего compose в nginx-конфигурацию и создание независимого локального compose-файла без override, с корректными портами и обработкой ROOT_PATH/OpenAPI.",
      "created": "2026-02-13",
      "status": "IMPLEMENT_OK",
      "services": [
        "free-ai-selector-business-api",
        "free-ai-selector-data-postgres-api",
        "free-ai-selector-telegram-bot",
        "free-ai-selector-health-worker"
      ],
      "artifacts": {
        "prd": "_analysis/2026-02-13_F021_compose-nginx-local-modes.md",
        "research": "_research/2026-02-13_F021_compose-nginx-local-modes.md",
        "plan": "_plans/features/2026-02-13_F021_compose-nginx-local-modes.md"
      }
    },
    "F022": {
      "name": "error-classifier-fix",
      "title": "Исправление классификации ошибок LLM-провайдеров и защита от больших payload",
      "created": "2026-02-25",
      "status": "IN_PROGRESS",
      "services": [
        "free-ai-selector-business-api"
      ]
    },
    "F023": {
      "name": "error-resilience-and-telemetry",
      "title": "Cooldown для постоянных ошибок, exponential backoff и per-request telemetry",
      "created": "2026-02-25",
      "status": "IN_PROGRESS",
      "services": [
        "free-ai-selector-business-api"
      ]
    },
    "F024": {
      "name": "circuit-breaker",
      "title": "Circuit Breaker для AI-провайдеров",
      "created": "2026-02-25",
      "status": "IN_PROGRESS",
      "services": [
        "free-ai-selector-business-api"
      ]
    },
    "F025": {
      "name": "server-backpressure",
      "title": "Серверная защита от перегрузки: HTTP 429/503 + backpressure",
      "created": "2026-02-25",
      "status": "IN_PROGRESS",
      "services": [
        "free-ai-selector-business-api"
      ]
    },
    "F026": {
      "name": "unified-json-logging",
      "title": "Унификация логов в единый JSON-формат",
      "created": "2026-02-26",
      "status": "IN_PROGRESS",
      "services": [
        "free-ai-selector-business-api",
        "free-ai-selector-data-postgres-api",
        "free-ai-selector-health-worker",
        "free-ai-selector-telegram-bot"
      ]
    }
  },
  "next_feature_id": 27,
  "services": [],
  "gate_aliases": {
    "PRD_READY": "ANALYSIS_READY",
    "RESEARCH_DONE": "RESEARCH_READY",
    "IMPLEMENT_OK": "CODE_READY",
    "REVIEW_OK": "REVIEW_READY",
    "QA_PASSED": "TESTING_READY",
    "ALL_GATES_PASSED": "VALIDATION_READY"
  }
}